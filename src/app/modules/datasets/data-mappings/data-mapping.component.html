<seed-page
  [config]="{
    title: 'Data Mapping',
    breadcrumbs: ['Datasets', 'Data Mapping'],
    titleIcon: 'fa-solid:map',
    action: toggleHelp,
    actionIcon: 'fa-solid:circle-question',
  }"
>
  <div class="h-full-page-tabs" id="content">
    
    <mat-drawer-container class="h-full">
      <mat-drawer class="w-1/2" #drawer [(opened)]="helpOpened" mode="over" position="end">
        <ng-container *ngTemplateOutlet="helpTemplate"></ng-container>
      </mat-drawer>
      <ng-container *ngTemplateOutlet="mainTemplate"></ng-container>
    </mat-drawer-container>
    
  </div>
</seed-page>


<!-- HELP CONTENT -->
<ng-template class="w-1/3" #helpTemplate>
  <seed-data-mapping-help></seed-data-mapping-help>
</ng-template>

<!-- MAIN CONTENT -->
<ng-template #mainTemplate>

  <mat-stepper class="stepper-disable-hover bg-transparent p-0" #stepper [linear]="true">
    <mat-step [completed]="completed[1]" label="Map Data">
      <seed-map-data
      [cycle]="cycle"
      [firstFiveRows]="firstFiveRows"
      [importFile]="importFile"
      [mappingSuggestions]="mappingSuggestions"
      [matchingPropertyColumns]="matchingPropertyColumns"
      [matchingTaxLotColumns]="matchingTaxLotColumns"
      [orgId]="orgId"
      [rawColumnNames]="rawColumnNames"
      (completed)="startMapping()"
      ></seed-map-data>
    </mat-step>
    
    <mat-step [completed]="completed[2]" label="Mapping" editable="false">
      <seed-progress-bar
        [progress]="progressBarObj.progress"
        [total]="progressBarObj.total"
        title="Uploading Data..."
      ></seed-progress-bar>
    </mat-step>

    <mat-step [completed]="completed[3]" label="Save Mappings">
      <seed-save-mappings
      [columns]="columns"
      [cycle]="cycle"
      [mappingResultsResponse]="mappingResultsResponse"
      [org]="org"
      [orgId]="orgId"
      (completed)="matchMergeProgress.startMatchMerge()"
      ></seed-save-mappings>
    </mat-step>

    <mat-step [completed]="completed[4]" label="Matching & Merging" editable="false">
      <seed-matching-merging #matchMergeProgress
      ></seed-matching-merging>
    </mat-step>

  </mat-stepper>

  

</ng-template>