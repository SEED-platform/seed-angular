<seed-page [config]="{ titleIcon: 'fa-solid:envelope', title: 'Email Templates' }">
  <div class="flex w-full flex-row items-center justify-end gap-x-2">
    <form class="mt-4 flex w-100" [formGroup]="selectedTemplateForm">
      <mat-label class="text-secondary mt-4 mr-4">Templates</mat-label>
      <mat-form-field class="w-full flex">
        <mat-select (selectionChange)="selectTemplate()" formControlName="selectedTemplate">
          @for (template of templates; track template.id) {
            <mat-option [value]="template.id">{{ template.name }}</mat-option>
          }
        </mat-select>
      </mat-form-field>
    </form>

    <a class="flex" (click)="rename()" mat-stroked-button matTooltip="Rename">
      <mat-icon class="fill-blue-700 icon-size-4" svgIcon="fa-solid:eraser"></mat-icon>
    </a>
    <a class="flex" (click)="delete()" mat-stroked-button matTooltip="Delete">
      <mat-icon class="fill-red-700 icon-size-4" svgIcon="fa-solid:x"></mat-icon>
    </a>
    <a class="flex" (click)="create()" mat-stroked-button matTooltip="Create New">
      <mat-icon class="fill-blue-300 icon-size-4" svgIcon="fa-solid:folder-plus"></mat-icon>
    </a>
  </div>

  <div class="ml-8 w-2/3">
    <form class="m-l-8 flex flex-col" [formGroup]="templateForm">
      <mat-form-field class="flex">
        <mat-label class="text-secondary">Subject</mat-label>
        <input matInput formControlName="subject" />
        @if (templateForm.controls.subject?.hasError('required')) {
          <mat-error>Subject is a required field</mat-error>
        }
      </mat-form-field>

      <mat-label class="text-secondary">Content</mat-label>
      <ngx-wig class="" formControlName="html_content"></ngx-wig>
      @if (templateForm.controls.html_content?.hasError('required')) {
        <mat-error>Content is a required field</mat-error>
      }
      <div class="flex mt-4">
        <button [disabled]="templateForm.invalid || templateForm.pending" (click)="save()" mat-flat-button color="primary">
          <span>Save Changes</span>
        </button>
      </div>
    </form>
  </div>
</seed-page>
