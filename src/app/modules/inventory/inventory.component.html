<seed-page
  [config]="{
    title: 'Properties',
    titleIcon: 'fa-solid:building',
  }"
>
</seed-page>

<div class="flex min-w-0 flex-auto flex-col" *transloco="let t">
  <!-- Header -->
  <div class="bg-card">
    <div class="mx-auto flex w-full max-w-screen-xl flex-col px-6 sm:px-8">
      <!-- Tabs -->
      <seed-page-inventory-tab [config]="{ tabs, action: toggleInventoryType.bind(this) }"></seed-page-inventory-tab>
    </div>
  </div>

  <!-- Main -->
  <div class="z-1 -mt-px flex-auto border-t pt-2">
    <!-- config -->
    <!-- <mat-expansion-panel #panel [hideToggle]="true">
      <mat-expansion-panel-header class="flex flex-row-reverse gap-2">
          <mat-icon 
            svgIcon="fa-solid:chevron-down"
            class="chevron transition-transform duration-300 scale-50"
            [class.rotate-180]="panel.expanded"
            ></mat-icon>
          @if (!panel.expanded) {
            <div class="flex p-2 font-normal">
              <div>
                Cycle: <span [ngClass]="{ 'border border-gray-500 rounded px-4 py-2 mr-4': cycle }">{{ cycle ? cycle.name : '' }}</span> 
              </div>
              <div>
                Profile: <span [ngClass]="{ 'border border-gray-500 rounded px-4 py-2': profile }">{{ profile ? profile.name : '' }}</span>
              </div>
            </div>
          }

      </mat-expansion-panel-header> 
      expanded stuff here
    </mat-expansion-panel> -->

    <!-- GRID CONFIG -->
    <div class="m-2 flex">

      <seed-inventory-grid-actions
        [cycleId]="cycleId"
        [gridApi]="gridApi"
        [inventory]="inventory"
        (loadInventory)="loadInventory()"
        [orgId]="orgId"
        [profile]="profile"
        [selectedViewIds]="selectedViewIds"
      ></seed-inventory-grid-actions>

      <mat-form-field class="mr-2 w-60" appearance="outline">
        <mat-label>Cycle</mat-label>
        <mat-select [(value)]="cycleId" (selectionChange)="onCycleChange($event.value)" class="text-sm">
          @for (item of cycles; track item) {
            <mat-option [value]="item.id" class="text-sm">{{ item.name }}</mat-option>
          }
        </mat-select>
      </mat-form-field>

      <mat-form-field class="mr-1" appearance="outline">
        <mat-label>Profile</mat-label>
        <mat-select [(value)]="profileId" (selectionChange)="onProfileChange($event.value)" class="text-sm">
          @for (item of profiles; track item) {
            <mat-option [value]="item.id" class="text-sm">{{ item.name }}</mat-option>
          }
        </mat-select>
      </mat-form-field>

      <button mat-stroked-button (click)="openFilterSortModal()" class="mt-2">Filters / Sorts</button>
    </div>
    <!-- INVENTORY GRID -->
    <seed-inventory-grid
      #grid
      [columnDefs]="columnDefs"
      [pagination]="pagination"
      [rowData]="rowData"
      [labelLookup]="labelLookup"
      [selectedViewIds]="selectedViewIds"
      (pageChange)="onPageChange($event)"
      (filterSortChange)="onFilterSortChange($event)"
      (gridReady)="onGridReady($event)"
      (selectionChanged)="onSelectionChanged()"
    ></seed-inventory-grid>
  </div>
</div>
